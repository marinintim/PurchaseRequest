// Generated by CoffeeScript 1.4.0
(function() {

  define("Models/CreditCard", ['Models/Nested'], function(NestedModel) {
    var CreditCard;
    return CreditCard = NestedModel.extend({
      defaults: {
        number: "",
        cardholder: "",
        expiration_month: "",
        expiration_year: ""
      },
      validate: function(attributes) {
        var isExpired, _temp;
        if (attributes == null) {
          attributes = this.attributes;
        }
        if (this.isNew()) {
          isExpired = function(m, y) {
            var expire_date, today_date, _temp;
            expire_date = new Date();
            expire_date.setDate(1);
            expire_date.setFullYear((_temp = parseInt(y, 10)) > 99 ? _temp : _temp + 2000);
            expire_date.setMonth(parseInt(m, 10));
            today_date = new Date();
            return expire_date - today_date <= 0;
          };
          if ((_temp = this.isEmpty())) {
            return "Credit card form is incomplete: " + _temp;
          }
          if (!/^[0-9]+$/.test(attributes.number.replace(/[\s-\\\/]+/g, ""))) {
            return "Credit card form: invalid number";
          }
          if (!$.isNumeric(attributes.expiration_month)) {
            return "Credit card form: invalid expiration month";
          }
          if (!$.isNumeric(attributes.expiration_year)) {
            return "Credit card form: invalid expiration year";
          }
          if (isExpired(attributes.expiration_month, attributes.expiration_year)) {
            return "Credit card form: card is already expired";
          }
        }
      }
    });
  });

}).call(this);
