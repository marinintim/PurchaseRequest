// Generated by CoffeeScript 1.7.1
(function() {
  define("Views/CreditCard", ["Models/CreditCard", "Collections/CreditCard"], function(CreditCard, CreditCardCollection) {
    var CreditCardView;
    return CreditCardView = Backbone.View.extend({
      el: $(".pr-creditcard"),
      events: {
        "change": "render"
      },
      initialize: function() {
        this.model = new CreditCard;
        this.collection = new CreditCardCollection;
        return this.collection.fetch({
          success: _.bind(this.render, this)
        });
      },
      template: Handlebars.compile($("#pr-creditcard").html()),
      templateForm: Handlebars.compile($("#pr-creditcard-form").html()),
      render: function() {
        var selected;
        selected = $(".pr-creditcard select :selected").val();
        console.log(JSON.stringify(this.collection));
        this.$el.html(this.template({
          cards: this.collection.toJSON()
        }));
        if (selected === "new") {
          this.$el.append(this.templateForm());
        }
        $(".pr-creditcard select [value=" + selected + "]").attr("selected", "selected");
      }
    });
  });

}).call(this);
